<div class="row">
  <div class="col-md-3">
    <dlm-page-header [title]="'page.policies.header'"></dlm-page-header>
  </div>
  <div class="col-md-9">
    <div class="pull-right filters-block page-section">

      <div class="filter-item" *ngIf="(policies$ | async)?.length > 0">
        <dlm-table-filter
          [filterBy]="filterBy"
          [initialFilters]="initialFilters"
          [data]="filteredPolicies$ | async"
          (onFilter)="onFilter($event)"></dlm-table-filter>
      </div>

      <div class="pull-left filter-item" *ngIf="(policies$ | async)?.length > 0">
        <policy-service-filter (onFilter)="filterPoliciesByService($event)"></policy-service-filter>
      </div>

      <dlm-add-entity-button
        [canAddPolicy]="(resourceAvailability$ | async)?.canAddPolicy"
        [canAddPairing]="(resourceAvailability$ | async)?.canAddPairing">
      </dlm-add-entity-button>
    </div>
  </div>
</div>

<div class="row page-section">
  <div class="col-md-12" *ngIf="(policies$ | async)?.length > 0; else noPolicies">
    <dlm-policy-table
      [policies]="filteredPolicies$ | async"
      [clusters]="clusters$ | async"
      [activePolicyId]="activePolicyId"
      (detailsToggle)="handleDetailsToggle($event)"
    >
    </dlm-policy-table>
  </div>
  <ng-template #noPolicies>
    <div class="alert-wrapper">
      <div class="alert alert-warning" role="alert">
        <div *ngIf="(pairings$ | async).length > 0; else noPairings">
          {{ "page.policies.no_policies" | translate }}
          <button type="button" class="btn btn-primary" [routerLink]="'/policies/create'">
            {{ "page.policies.create_button_text" | translate }}
          </button>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #noPairings>
    <div *ngIf="(clusters$ | async).length > 1; else noClusters">
      {{ "page.policies.no_pairings" | translate }}
      <button type="button" class="btn btn-primary" [routerLink]="'/pairings/create'">
        {{ "page.pairings.create_button_text" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #noClusters>
    {{ "page.policies.no_clusters" | translate }}
  </ng-template>
</div>
