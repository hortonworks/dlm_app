<!--
  ~ Copyright  (c) 2016-2017, Hortonworks Inc.  All rights reserved.
  ~
  ~ Except as expressly permitted in a written agreement between you or your company
  ~ and Hortonworks, Inc. or an authorized affiliate or partner thereof, any use,
  ~ reproduction, modification, redistribution, sharing, lending or other exploitation
  ~ of all or any part of the contents of this software is strictly prohibited.
  -->

<dlm-table
  [rowDetailHeight]="550"
  [rowDetailTemplate]="rowDetailRef"
  [theme]="tableTheme"
  [columns]="columns"
  [columnMode]="columnMode"
  [rows]="clusters">
</dlm-table>

<ng-template #statusCell let-status="value" let-cluster="row">
  <span>
    <dlm-cluster-status-icon [cluster]="cluster"></dlm-cluster-status-icon>
    <span [innerHtml]="status"></span>
  </span>
</ng-template>

<ng-template #slashIconCell>
  <span class="slash">&#47;</span>
</ng-template>

<ng-template #nameCell let-name="value">
  <span class="cluster-name">{{name}}</span>
</ng-template>

<ng-template #dcCell let-name="value">
  <span class="datacenter-name">{{name}}</span>
</ng-template>

<ng-template let-stats="value" let-cluster="row" #usageCell>
  <div class="text-primary cell-content actionable" qe-attr="cluster-details" (click)="toggleClusterDetails(cluster)">
    <span [innerHTML]="stats.CapacityUsed | bytesSize"></span> / <span [innerHTML]="stats.CapacityTotal | bytesSize"></span>
    <i class="fa fa-chevron-down"></i>
  </div>
</ng-template>

<ng-template let-value="value" #plainCell>
  <span *ngIf="value || value === 0; else emptyValue" class="cell-content">{{value}}</span>
  <ng-template #emptyValue>
    <i class="fa fa-minus"></i>
  </ng-template>
</ng-template>

<ng-template let-location="value" #locationCell>
  <span>{{location.city}}, {{location.country}}</span>
</ng-template>

<ng-template let-cluster="row" #addActionsCell>
  <div class="add-actions-container">
    <div class="add-actions-icon" qe-attr="add-entity-icon">
      <i class="fa fa-plus text-success"></i>
    </div>
    <div class="add-actions-buttons">
      <button class="btn btn-secondary" qe-attr="add-pairing" type="button" [routerLink]="['/pairings/create']" [queryParams]="{'firstClusterId': cluster.id}" [disabled]="clusters.length - cluster.pairsCounter - 1 === 0">
        {{ "page.clusters.card.create_pair_text" | translate }}
      </button>
      <button class="btn btn-secondary" qe-attr="add-policy" type="button" [routerLink]="['/policies/create']" [queryParams]="{'sourceClusterId': cluster.id}" [disabled]="cluster.pairsCounter === 0">
        {{ "page.clusters.card.create_policy_text" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template let-cluster="row" ngx-datatable-row-detail-template #rowDetailRef>
  <div class="row">
    <div class="col col-md-12">
      <dlm-hdfs-browser [selectFiles]="false" [rootPath]="hdfsRootPath" [clusterId]="cluster.id" (select)="onSelectFile($event)"></dlm-hdfs-browser>
    </div>
  </div>
</ng-template>
